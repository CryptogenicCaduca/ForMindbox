В БД есть таблица с регистрацией клиентов вида CustomerId, RegistrationDateTime, Name и таблица с покупками клиентов вида CustomerId, PurchaseDatetime, ProductName. Напишите SQL запрос, который выберет имена клиентов, которые когда-либо покупали молоко, но не покупали сметану за последний месяц.

--In previous version query selects additional customers who did not buy milk, but buy sour cream
--Here is bugfix
SELECT Name  FROM [Test2].[dbo].[Customers]
INNER JOIN [Test2].[dbo].[Purchases]
ON Customers.CustomerId=Purchases.CustomerId
WHERE ProductName='Молоко' AND [Customers].CustomerId NOT IN
	(SELECT CustomerId FROM [Test2].[dbo].Purchases
	 WHERE (ProductName='Сметана' AND DATEDIFF(MONTH,PurchaseDatetime,GETDATE()) = 0)
	 GROUP BY CustomerId)

